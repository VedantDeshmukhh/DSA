#include <iostream>
using namespace std;
#define MAX 5

// ----- Array Queue -----
class ArrayQueue {
    int arr[MAX];
    int front, rear;
public:
    ArrayQueue() {
        front = -1;
        rear = -1;
    }

    // Enqueue operation
    void enqueue(int data) {
        if (rear == MAX - 1) {
            cout << "Queue Overflow (Array)!\n";
            return;
        }
        if (front == -1) front = 0;
        arr[++rear] = data;
        cout << data << " enqueued to Array Queue.\n";
    }

    // Dequeue operation
    void dequeue() {
        if (front == -1 || front > rear) {
            cout << "Queue Underflow (Array)!\n";
            return;
        }
        cout << arr[front++] << " dequeued from Array Queue.\n";
        if (front > rear) {
            front = rear = -1;
        }
    }

    // Peek operation
    void peek() {
        if (front == -1 || front > rear) {
            cout << "Queue is empty (Array)!\n";
            return;
        }
        cout << "Front element (Array): " << arr[front] << endl;
    }

    // Display elements
    void display() {
        if (front == -1 || front > rear) {
            cout << "Queue is empty (Array)!\n";
            return;
        }
        cout << "Array Queue elements: ";
        for (int i = front; i <= rear; i++)
            cout << arr[i] << " ";
        cout << endl;
    }
};

// ----- Node structure for Linked List Queue -----
struct Node {
    int data;
    Node* next;
};

// ----- Linked List Queue -----
class LinkedListQueue {
    Node *front, *rear;
public:
    LinkedListQueue() {
        front = rear = nullptr;
    }

    // Enqueue operation
    void enqueue(int data) {
        Node* newNode = new Node();
        newNode->data = data;
        newNode->next = nullptr;
        if (rear == nullptr) {
            front = rear = newNode;
            cout << data << " enqueued to Linked List Queue.\n";
            return;
        }
        rear->next = newNode;
        rear = newNode;
        cout << data << " enqueued to Linked List Queue.\n";
    }

    // Dequeue operation
    void dequeue() {
        if (front == nullptr) {
            cout << "Queue Underflow (Linked List)!\n";
            return;
        }
        cout << front->data << " dequeued from Linked List Queue.\n";
        Node* temp = front;
        front = front->next;
        if (front == nullptr)
            rear = nullptr;
        delete temp;
    }

    // Peek operation
    void peek() {
        if (front == nullptr) {
            cout << "Queue is empty (Linked List)!\n";
            return;
        }
        cout << "Front element (Linked List): " << front->data << endl;
    }

    // Display elements
    void display() {
        if (front == nullptr) {
            cout << "Queue is empty (Linked List)!\n";
            return;
        }
        cout << "Linked List Queue elements: ";
        Node* temp = front;
        while (temp != nullptr) {
            cout << temp->data << " ";
            temp = temp->next;
        }
        cout << endl;
    }

    // Destructor to free memory
    ~LinkedListQueue() {
        while (front != nullptr) {
            Node* temp = front;
            front = front->next;
            delete temp;
        }
    }
};

// ----- Main Function -----
int main() {
    ArrayQueue arrayQueue;
    LinkedListQueue linkedListQueue;
    int mainChoice, choice, value;

    while (true) {
        cout << " QUEUE IMPLEMENTATION MENU\n";
        cout << "1. Use Array Queue\n";
        cout << "2. Use Linked List Queue\n";
        cout << "3. Exit\n";
        cout << "Enter your choice: ";
        cin >> mainChoice;

        if (mainChoice == 3) {
            cout << "Exiting program...\n";
            break;
        }

        switch (mainChoice) {
            case 1:
                while (true) {
                    cout << "\n--- Array Queue Operations ---\n";
                    cout << "1. Enqueue\n2. Dequeue\n3. Peek\n4. Display\n5. Back to Main Menu\n";
                    cout << "Enter your choice: ";
                    cin >> choice;
                    if (choice == 5) break;

                    switch (choice) {
                        case 1:
                            cout << "Enter value to enqueue: ";
                            cin >> value;
                            arrayQueue.enqueue(value);
                            break;
                        case 2:
                            arrayQueue.dequeue();
                            break;
                        case 3:
                            arrayQueue.peek();
                            break;
                        case 4:
                            arrayQueue.display();
                            break;
                        default:
                            cout << "Invalid choice! Try again.\n";
                    }
                }
                break;

            case 2:
                while (true) {
                    cout << "\n--- Linked List Queue Operations ---\n";
                    cout << "1. Enqueue\n2. Dequeue\n3. Peek\n4. Display\n5. Back to Main Menu\n";
                    cout << "Enter your choice: ";
                    cin >> choice;
                    if (choice == 5) break;

                    switch (choice) {
                        case 1:
                            cout << "Enter value to enqueue: ";
                            cin >> value;
                            linkedListQueue.enqueue(value);
                            break;
                        case 2:
                            linkedListQueue.dequeue();
                            break;
                        case 3:
                            linkedListQueue.peek();
                            break;
                        case 4:
                            linkedListQueue.display();
                            break;
                        default:
                            cout << "Invalid choice! Try again.\n";
                    }
                }
                break;

            default:
                cout << "Invalid choice! Try again.\n";
        }
    }
    return 0;
}
